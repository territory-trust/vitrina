<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–Ω–∏–π –û—á–∏—Å–Ω–∏–∫</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <style>
        :root { --bg: #0d0f12; --olive: #556b2f; --danger: #8b0000; --text: #d1d5db; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; padding: 0; margin: 0; text-align: center; font-size: 16px; }
        
        .system-nav { background: #000; padding: 10px; display: flex; justify-content: center; gap: 10px; border-bottom: 1px solid #333; margin-bottom: 20px; }
        .sys-btn { text-decoration: none; color: #888; font-size: 14px; padding: 8px 15px; border-radius: 6px; border: 1px solid #333; }
        .sys-btn:hover { color: #fff; border-color: var(--olive); }
        .sys-btn.active { background: var(--danger); color: #fff; border-color: red; }

        .panel { background: #14171c; padding: 30px; border-radius: 20px; border: 1px solid #333; max-width: 500px; margin: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        .btn { padding: 20px; border: none; width: 100%; border-radius: 15px; font-weight: bold; cursor: pointer; margin-bottom: 15px; font-size: 16px; text-transform: uppercase; color: #fff; transition: 0.2s; }
        .btn-nuke { background: linear-gradient(180deg, #8b0000 0%, #580000 100%); box-shadow: 0 4px 0 #3d0000; }
        .btn-nuke:active { transform: translateY(4px); box-shadow: none; }
        .btn-soft { background: #2a2e35; border: 1px solid #444; box-shadow: 0 4px 0 #1a1c20; }

        #log { margin-top: 20px; background: #000; padding: 15px; border-radius: 12px; color: #ff4141; text-align: left; height: 200px; font-family: monospace; overflow-y: auto; font-size: 13px; border: 1px solid #333; }
    </style>
</head>
<body>

    <div class="system-nav">
        <a href="index.html" class="sys-btn">üè† –í–Ü–¢–†–ò–ù–ê</a>
        <a href="scout_mta.html" class="sys-btn">üïµÔ∏è –†–û–ó–í–Ü–î–ù–ò–ö</a>
        <a href="agent_ai.html" class="sys-btn">ü§ñ AI –ê–ì–ï–ù–¢</a>
        <a href="cleaner.html" class="sys-btn active">üóëÔ∏è –û–ß–ò–°–ù–ò–ö</a>
    </div>

    <div class="panel">
        <h2 style="color:var(--danger); margin-top:0;">–°–ò–°–¢–ï–ú–ù–ò–ô –û–ß–ò–°–ù–ò–ö</h2>
        <p style="color:#777; margin-bottom:20px;">–û—á–∏—â–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö Supabase</p>
        
        <button class="btn btn-nuke" onclick="nukeAll()">‚ò¢Ô∏è –í–ò–î–ê–õ–ò–¢–ò –í–°–Ü –¢–û–í–ê–†–ò (RESET)</button>
        <button class="btn btn-soft" onclick="cleanUnprocessed()">üßπ –í–∏–¥–∞–ª–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ –Ω–µ–æ–±—Ä–æ–±–ª–µ–Ω—ñ</button>
        
        <div id="log">> –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞...</div>
    </div>

    <script>
        const sb = supabase.createClient(CONFIG.SB_URL, CONFIG.SB_KEY);
        const log = document.getElementById('log');

        async function nukeAll() {
            if(!confirm("–û–ß–ò–°–¢–ò–¢–ò –í–°–Æ –ë–ê–ó–£? –¶–µ –≤–∏–¥–∞–ª–∏—Ç—å —É—Å—ñ —Ç–æ–≤–∞—Ä–∏ —Ç–∞ —ó—Ö –æ–ø–∏—Å–∏.")) return;
            log.innerHTML += `<br>> –ü–æ—á–∞—Ç–æ–∫ –ø–æ–≤–Ω–æ—ó –∑–∞—á–∏—Å—Ç–∫–∏...`;

            // –°–ø–æ—á–∞—Ç–∫—É –≤–∏–¥–∞–ª—è—î–º–æ –≤—Å—ñ –∑–∞–ø–∏—Å–∏ –∑ —Ç–∞–±–ª–∏—Ü—ñ –æ–ø–∏—Å—ñ–≤
            const { error: err1 } = await sb.from('ai_content').delete().neq('fancy_description', 'FORCED_DELETE_ALL');
            
            // –í–∏–¥–∞–ª—è—î–º–æ –≤—Å—ñ –∑–∞–ø–∏—Å–∏ –∑ —Ç–∞–±–ª–∏—Ü—ñ —Ç–æ–≤–∞—Ä—ñ–≤ (—Ñ—ñ–ª—å—Ç—Ä –ø–æ –Ω–∞–∑–≤—ñ, —è–∫–∞ —Ç–æ—á–Ω–æ –Ω–µ –¥–æ—Ä—ñ–≤–Ω—é—î –ø—É—Å—Ç–æ—Ç—ñ)
            const { error: err2 } = await sb.from('products').delete().neq('title', 'FORCED_DELETE_ALL');
            
            if(err1 || err2) {
                log.innerHTML += `<br>‚ùå –ü–æ–º–∏–ª–∫–∞: ${err2?.message || err1?.message}`;
            } else {
                log.innerHTML += `<br>‚úÖ –ë–ê–ó–ê –ü–û–í–ù–Ü–°–¢–Æ –û–ß–ò–©–ï–ù–ê.`;
            }
            log.scrollTop = log.scrollHeight;
        }

        async function cleanUnprocessed() {
            if(!confirm("–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä–∏ –±–µ–∑ AI –æ–ø–∏—Å—ñ–≤?")) return;
            log.innerHTML += `<br>> –í–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–µ–æ–±—Ä–æ–±–ª–µ–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤...`;
            
            const { error } = await sb.from('products').delete().eq('is_processed_ai', false);
            
            if(error) {
                log.innerHTML += `<br>‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            } else {
                log.innerHTML += `<br>‚úÖ –ù–µ–æ–±—Ä–æ–±–ª–µ–Ω—ñ —Ç–æ–≤–∞—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω—ñ.`;
            }
            log.scrollTop = log.scrollHeight;
        }
    </script>
</body>
</html>
