<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–Ω–∏–π –û—á–∏—Å–Ω–∏–∫</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <style>
        :root { --bg: #0d0f12; --olive: #556b2f; --danger: #8b0000; --text: #d1d5db; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; padding: 0; margin: 0; text-align: center; font-size: 16px; }
        
        /* –ù–∞–≤—ñ–≥–∞—Ü—ñ—è */
        .system-nav { background: #000; padding: 10px; display: flex; justify-content: center; gap: 10px; border-bottom: 1px solid #333; margin-bottom: 20px; }
        .sys-btn { text-decoration: none; color: #888; font-size: 14px; padding: 8px 15px; border-radius: 6px; border: 1px solid #333; }
        .sys-btn:hover { color: #fff; border-color: var(--olive); }
        .sys-btn.active { background: var(--danger); color: #fff; border-color: red; }

        .panel { background: #14171c; padding: 30px; border-radius: 20px; border: 1px solid #333; max-width: 500px; margin: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        .btn { padding: 20px; border: none; width: 100%; border-radius: 15px; font-weight: bold; cursor: pointer; margin-bottom: 15px; font-size: 16px; text-transform: uppercase; color: #fff; transition: 0.2s; }
        
        /* –ö–Ω–æ–ø–∫–∞ –ø–æ–≤–Ω–æ—ó –æ—á–∏—Å—Ç–∫–∏ - –ë–æ—Ä–¥–æ–≤–∞ */
        .btn-nuke { background: linear-gradient(180deg, #8b0000 0%, #580000 100%); box-shadow: 0 4px 0 #3d0000; }
        .btn-nuke:active { transform: translateY(4px); box-shadow: none; }
        .btn-nuke:hover { background: linear-gradient(180deg, #a50000 0%, #700000 100%); }

        /* –ö–Ω–æ–ø–∫–∞ —á–∞—Å—Ç–∫–æ–≤–æ—ó –æ—á–∏—Å—Ç–∫–∏ - –°—ñ—Ä–∞ */
        .btn-soft { background: #2a2e35; border: 1px solid #444; box-shadow: 0 4px 0 #1a1c20; }
        .btn-soft:active { transform: translateY(4px); box-shadow: none; }
        .btn-soft:hover { background: #333840; border-color: #666; }

        #log { margin-top: 20px; background: #000; padding: 15px; border-radius: 12px; color: #ff4141; text-align: left; height: 200px; font-family: monospace; overflow-y: auto; font-size: 13px; border: 1px solid #333; }
    </style>
</head>
<body>

    <div class="system-nav">
        <a href="index.html" class="sys-btn">üè† –í–Ü–¢–†–ò–ù–ê</a>
        <a href="scout_mta.html" class="sys-btn">üïµÔ∏è –†–û–ó–í–Ü–î–ù–ò–ö</a>
        <a href="agent_ai.html" class="sys-btn">ü§ñ AI –ê–ì–ï–ù–¢</a>
        <a href="cleaner.html" class="sys-btn active">üóëÔ∏è –û–ß–ò–°–ù–ò–ö</a>
    </div>

    <div class="panel">
        <h2 style="color:var(--danger); margin-top:0;">–°–ò–°–¢–ï–ú–ù–ò–ô –û–ß–ò–°–ù–ò–ö</h2>
        <p style="color:#777; margin-bottom:20px;">–£–≤–∞–≥–∞! –¶—è –¥—ñ—è –Ω–µ–∑–≤–æ—Ä–æ—Ç–Ω–∞.</p>
        
        <button class="btn btn-nuke" onclick="nukeAll()">‚ò¢Ô∏è –í–ò–î–ê–õ–ò–¢–ò –í–°–Ü –¢–û–í–ê–†–ò (RESET)</button>
        <button class="btn btn-soft" onclick="cleanUnprocessed()">üßπ –í–∏–¥–∞–ª–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ –Ω–µ–æ–±—Ä–æ–±–ª–µ–Ω—ñ (–±–µ–∑ AI)</button>
        
        <div id="log">> –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ –æ—á–∏—â–µ–Ω–Ω—è...</div>
    </div>

    <script>
        const sb = supabase.createClient(CONFIG.SB_URL, CONFIG.SB_KEY);
        const log = document.getElementById('log');

        // –§—É–Ω–∫—Ü—ñ—è –ø–æ–≤–Ω–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è
        async function nukeAll() {
            if(!confirm("–í–ò –í–ü–ï–í–ù–ï–ù–Ü? –¶–µ –≤–∏–¥–∞–ª–∏—Ç—å –í–°–Ü —Ç–æ–≤–∞—Ä–∏ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.")) return;
            
            log.innerHTML += `<br>> –ü–æ—á–∞—Ç–æ–∫ –ø–æ–≤–Ω–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è...`;
            
            // –í–∏–¥–∞–ª—è—î–º–æ –∑–≤'—è–∑–∞–Ω—ñ –æ–ø–∏—Å–∏ —Å–ø–æ—á–∞—Ç–∫—É (—Ö–æ—á–∞ –∫–∞—Å–∫–∞–¥ –º–∞—î —Å–ø—Ä–∞—Ü—é–≤–∞—Ç–∏, –∞–ª–µ —Ç–∞–∫ –Ω–∞–¥—ñ–π–Ω—ñ—à–µ)
            await sb.from('ai_content').delete().neq('id', 0);
            
            // –í–∏–¥–∞–ª—è—î–º–æ —Ç–æ–≤–∞—Ä–∏
            const { error, count } = await sb.from('products').delete().neq('id', 0); // neq id 0 - —Ö–∞–∫ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤—Å—å–æ–≥–æ
            
            if(error) {
                log.innerHTML += `<br>‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            } else {
                log.innerHTML += `<br>‚úÖ –ë–∞–∑–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –æ—á–∏—â–µ–Ω–∞!`;
                log.innerHTML += `<br>> –ú–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –†–æ–∑–≤—ñ–¥–Ω–∏–∫–∞ –∑–∞–Ω–æ–≤–æ.`;
            }
            log.scrollTop = log.scrollHeight;
        }

        // –§—É–Ω–∫—Ü—ñ—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ "—Å–º—ñ—Ç—Ç—è" (—Ç–µ, —â–æ —â–µ –Ω–µ –ø—Ä–æ–π—à–ª–æ —á–µ—Ä–µ–∑ AI)
        async function cleanUnprocessed() {
            if(!confirm("–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä–∏, —è–∫—ñ —â–µ –ù–ï –º–∞—é—Ç—å –æ–ø–∏—Å—É –≤—ñ–¥ AI?")) return;

            log.innerHTML += `<br>> –û—á–∏—â–µ–Ω–Ω—è –Ω–µ–æ–±—Ä–æ–±–ª–µ–Ω–∏—Ö —á–µ—Ä–Ω–µ—Ç–æ–∫...`;
            
            const { error } = await sb.from('products').delete().eq('is_processed_ai', false);
            
            if(error) {
                log.innerHTML += `<br>‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            } else {
                log.innerHTML += `<br>‚úÖ –ß–µ—Ä–Ω–µ—Ç–∫–∏ –≤–∏–¥–∞–ª–µ–Ω–æ. –ì–æ—Ç–æ–≤—ñ —Ç–æ–≤–∞—Ä–∏ –∑–∞–ª–∏—à–µ–Ω–æ.`;
            }
            log.scrollTop = log.scrollHeight;
        }
    </script>
</body>
</html>
